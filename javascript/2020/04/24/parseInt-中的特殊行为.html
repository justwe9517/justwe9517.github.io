<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>parseInt 中的诡异行为</title><link rel="stylesheet" type="text/css" href="/assets/main-dark.css"></head>
<body>
    <div class="container"><header>
    <div class="menu">
        <ul style="display: flex; flex: 1;">
            <li><a href="/">夏虫的博客</a></li>
        </ul>
        <ul>
            <li><a href="/">最新</a></li>
            <li><a href="/categories.html">分类</a></li>
            <li><a href="/tags.html">标签</a></li>
            <li><a href="/collections.html">专题</a></li>
        </ul>
    </div>
</header><main class="main">
        <style>
    header {
        margin-bottom: 0 !important;
    }
</style>

<div>
<p>parseInt 是一个将字符串转化为特定进制的函数，函数本身没任何问题，但因为历史遗留问题这个函数总能产生一些意外的行为。</p>

<p>下面来看看这个函数的定义：</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Converts a string to an integer.
 * @param s A string to convert into a number.
 * @param radix A value between 2 and 36 that specifies the base of the number in numString.
 * If this argument is not supplied, strings with a prefix of '0x' are considered hexadecimal.
 * All other strings are considered decimal.
 */</span>
<span class="nx">declare</span> <span class="kd">function</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">radix</span><span class="p">?:</span> <span class="nx">number</span><span class="p">):</span> <span class="nx">number</span><span class="p">;</span>
</code></pre></div></div>

<p>在上面的注释中我们得知， redix 接受一个 2 - 36 之前的正数，如果不提供参数则视为十进制。这句话现在看着没有任何问题，但在之前真是这样吗？这类早期的缺陷也是很多面试官很喜欢问的。</p>

<p>其实在 ECMAScript 3 之前的时代，如果未指定 redix 参数，则会存在两种解析方式。</p>

<ol>
  <li>对于以 <code class="highlighter-rouge">0x</code> 或 <code class="highlighter-rouge">0X</code> 开头的字符串，parseInt 会将其按照 16 进制进行解析。</li>
  <li>对于以 <code class="highlighter-rouge">0</code> 开头的字符串，parseInt 会将其以 8 进制进行解析。</li>
</ol>

<p>对于上面第二点，就很容易产生一些意外问题，例如：如果你在老浏览器中通过执行 <code class="highlighter-rouge">parseInt("070")</code> 函数，最后返回出来的结果很可能是 56 而不是 70。对于这类问题在 ECMAScript 5 中已经的得到了解决，解决的方案也很简单，就是彻底移除了上面的 2. 解析规则。</p>



<hr>
<div id="gitment-container"></div>
<script src="/assets/gitment.js"></script>
<script>
    var gitment = new Gitment({
        id: 'article',
        owner: 'justwe9517',
        repo: 'justwe9517.github.io.comment',
        oauth: {
            client_id: '5478f070853e6da796cb',
            client_secret: '8e2107cb4181d5ec16429b919b334cf936b289b1',
        },
    });
    gitment.render('gitment-container')
</script>

</div>
    </main><footer>
    <span style="display: flex; flex: 1;" id="travis-ci"></span>
    <span id="cnzz"></span>
    COPYRIGHT © 2020. ALL RIGHTS RESERVED.
    <script>
        window.onload = function () {
            var script = document.createElement('script');
            script.setAttribute('type', "text/javascript");
            script.setAttribute('src', 'https://v1.cnzz.com/z_stat.php?id=1278709366&web_id=1278709366');
            script.style.opacity = 0;
            document.getElementsByTagName("body")[0].appendChild(script);
            var travisCi = document.createElement('img');
            travisCi.src = 'https://api.travis-ci.com/justwe9517/justwe9517.github.io.svg?branch=write';
            document.getElementById("travis-ci").appendChild(travisCi);
            var cnzz = document.createElement('img');
            cnzz.style.marginRight = '12px';
            cnzz.src = 'https://web.umeng.com/static/img/main/icon.gif';
            document.getElementById("cnzz").appendChild(cnzz);
        };
    </script>
</footer>
</div>
  </body>
</html>
